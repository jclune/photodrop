<!-- COPYRIGHT (C) Justin James Clune 2013
You should have received a copy of the GNU General Public License
along with this program.  If not, see <http://www.gnu.org/licenses/> -->

<!DOCTYPE HTML>
<html>
    <head>
        <title>Justin Clune's PhotoDrop 2013</title>
        <meta name="description" content="about website" />
        <meta name="keywords" content="keywords" />
        <meta charset="UTF-8" />
        <meta name="viewport" content="user-scalable=0, initial-scale=1.0">
        <meta name="apple-mobile-web-app-capable" content="yes" />
        <!--  load default CSS style -->
        <link rel="stylesheet" type="text/css" href="css/style.css" />
        <!--  load ipad style for 768-1024 width range
        <link rel="stylesheet" type="text/css" media="and only and 
        (min-device-width=768) and (max-device-width=1024)" href="css/ipadStyle.css" />
    	 <-- load phone style for 320-568 width range
    	<link rel="stylesheet" type="text/css" media="and only and
    	(min-device-width=320) and (max-device-width=568)" href="css/phoneStyle.css" /> -->
    	<script type="text/javascript" src="js/modernizr-1.5.min.js">
        </script>
    </head>
  
    
    <body class="linearBackground">
	    <header class="linearBackground">
	    	<!-- logo container. #topLogo takes precedence over .logo in CSS -->
	    	<div class="logo">
            <h2 id="topLogo1">PhotoUp</h2> 
            <input type="file" id="files" name="files[]" multiple />

            <!--<input type="file" id="files" name="files[]" accept="image/*" /> -->
            </div>
            <!-- <h4 id="topLogo2">Decorate with friends</h4> -->
	    	<!-- navigation container. #topNavList takes precedence over .navList -->
	    </header>
        
	    <!-- The #main container with everything between the header and footer  -->
	    <div id="main">
	    	<!-- main picCanvas container -->
	    	<div id="picCanvas">
                <!-- the buttons container -->
                <div id="canvasButtons">
                	<nav>
                        <ul class="buttonNavList">
                        	<li><button type="image" id="share" value="off">
                            </button></li>
                            <li><button type="image" id="frames" value="off">
                            </button></li>
                            <li><button type="image" id="emoji" value="off">
                            </button></li>
                            <li><button type="image" id="textOff" value="off">
                            </button></li>
                            <li><button type="image" id="glasses" value="off">
                            </button></li>
                        </ul>
                    </nav>
               	</div> <!-- buttons container (need to clear float)-->
                <div class="floatSeparator">
                </div>
                <!-- active pic canvas container for the stage (where the magic happens)-->
                <div id="activePicCanvas">
                </div>
                <!-- uploaded photo gallery and input for pic uploads -->
                <div id ="galleryBox" class="center">
                    <div>
                    <output id="list"></output>
                    </div>
                </div>			
               			
                <!-- the kinetic javascript that allows touch events to work-->
                <script src="js/kinetic-v4.3.1-beta2.js">
                </script>
                <script>
					/*Hide the url bar if mobile*/
					/mobile/i.test(navigator.userAgent) && setTimeout(function()
					{   window.scrollTo(0, 1); }, 1000); 
					
					 <!--script to load multiple photo thubnails but input is only for one
					 <!-- have to choose beteen  -->	
					// Check for the various File API support.
					if (window.File && window.FileReader && window.FileList && window.Blob) {
					// Great success! All the File APIs are supported.
					} else {
					alert('The File APIs are not fully supported in this browser.');
					}
					function handleFileSelect(evt) {
						var files = evt.target.files; // FileList object
						
						// Loop through the FileList and render image files as thumbnails.
						for (var i = 0, f; f = files[i]; i++) {
							
							// Only process image files.
							if (!f.type.match('image.*')) {
								continue;
							}
							
							var reader = new FileReader();
							
							// Closure to capture the file information.
							reader.onload = (function(theFile) {
								return function(e) {
									//Render canvas Background for 1st picture.
									if (files.length == 1){
										var span = document.createElement('span');
										span.innerHTML = ['<img class="activeBackground" src="', 
										e.target.result,
										'" title="', escape(theFile.name), '"/>'].join('');
										document.getElementById('listBack').insertBefore(span, null);
										//var backgroundImg = new Image({
										//src: e.target.result,
										//width: 309,
										//height: 309
										//});
										// yellowGroup.add(backgroundImg);
										// layer.draw();
									}
									else {
										// Render thumbnail.
										var span = document.createElement('span');
										span.innerHTML = ['<img class="thumb" src="', e.target.result,
										'" title="', escape(theFile.name), '"/>'].join('');
										document.getElementById('list').insertBefore(span, null);
									}
								};
							})(f);
						// Read in the image file as a data URL.
						reader.readAsDataURL(f);
						}
					}
					document.getElementById('files').addEventListener('change', handleFileSelect, false);

					/* load multiple images froum "sources" at the end of the script */
					function loadImages(sources, callback){
						var images = {};
						var loadedImages = 0;
						var numImages = 0;
						for (var src in sources) {
							numImages++;
						}
						for (var src in sources) {
							images[src] = new Image();
							images[src].onload = function(){
								if (++loadedImages >= numImages) {
									callback(images);
								}
							};
							images[src].src = sources[src];
						}
					}
					function initStage(images) {
						
					/*initiate stage*/
					var stage = new Kinetic.Stage({
						container: 'activePicCanvas',
						x: 0,
						y: 0,
						width: 309,
						height: 330
						});
					var layer = new Kinetic.Layer();
					var hiddenLayer = new Kinetic.Layer();
					/*ameba*/
					var ameba = new Kinetic.Image({
					  image: images.ameba,
					  x: 0,
					  y: 0,
					  width: 50,
					  height: 50,
					});
					var mustache = new Kinetic.Image({
					  image: images.mustache,
					  x: 0,
					  y: 0,
					  width: 50,
					  height: 50,
					});
					var mustacheOwl = new Kinetic.Image({
					  image: images.mustacheOwl,
					  x: 0,
					  y: 0,
					  width: 70,
					  height: 70,
					});
					var valentine = new Kinetic.Image({
					  image: images.valentine,
					  x: 0,
					  y: 0,
					  width: 100,
					  height: 100,
					});
					var framesPic = new Kinetic.Image({
					  image: images.frames,
					  x: 0,
					  y: 0,
					  width: 309,
					  height: 330,
					});

						/* draggable yellow and blue group locations */
					  var yellowGroup = new Kinetic.Group({
						x: 50,
						y: 80,
						draggable: true
					  });
					  var blueGroup = new Kinetic.Group({
						x: 200,
						y: 80,
						draggable: true
					  });
					  var amebaGroup = new Kinetic.Group({
						x: 115,
						y: 70,
						draggable: true
					  });
					  var glassesGroup = new Kinetic.Group({
						x: 50,
						y: 130,
						draggable: true
					  });
					  var emojiGroup = new Kinetic.Group({
						x: 80,
						y: 130,
						draggable: true
					  });
					  var textGroup = new Kinetic.Group({
						x: 150,
						y: 130,
						draggable: true
					  });
					  var framesGroup = new Kinetic.Group({
						  x: 0,
						  y: 0,
					  });
					  var hiddenGroup = new Kinetic.Group({
						  x: 0,
						  y: 0,
					  });
					  
					  
					  
					  /* blue circle > yellow circle > red box */
					  var box = new Kinetic.Rect({
						x: 20,
						y: 20,
						width: 30,
						height: 30,
						fill: 'red',
						stroke: 'black'
					  });
					  var yellowCircle = new Kinetic.Circle({
						x: 00,
						y: 00,
						radius: 20,
						fill: 'yellow',
						stroke: 'black'
					  });
					  var blueCircle = new Kinetic.Circle({
						x: 0,
						y: 0,
						radius: 20,
						fill: 'blue',
						stroke: 'black'
					  });
					  
					  /* build node tree (add shapes to groups) */

					  
					  layer.add(framesGroup);
					  layer.add(yellowGroup);
					  layer.add(blueGroup);
					  layer.add(glassesGroup);
					  layer.add(emojiGroup);
					  layer.add(textGroup);
					  layer.add(amebaGroup);
					  hiddenLayer.add(hiddenGroup);
					  
					  stage.add(hiddenLayer);
					  hiddenGroup.hide();
					  stage.add(layer);
					  layer.draw();
					  					  
					  document.getElementById('frames').addEventListener('click',function(frames) {
						/*framesPic.moveTo(framesGroup);
						layer.draw();*/
						
						if (document.getElementById('frames').value == "on"){
							document.getElementById('frames').value = "off";
							framesPic.moveTo(hiddenGroup);
							layer.draw();
					  	}
						else {
							document.getElementById('frames').value = "on";
							framesPic.moveTo(framesGroup);
							layer.draw();
					  	}
					  }, false);
					  document.getElementById('glasses').addEventListener('click',function(glasses) {
						/*framesPic.moveTo(framesGroup);
						layer.draw();*/
						
						if (document.getElementById('glasses').value == "on"){
							document.getElementById('glasses').value = "off";
							mustache.moveTo(hiddenGroup);
							layer.draw();
					  	}
						else {
							document.getElementById('glasses').value = "on";
							mustache.moveTo(glassesGroup);
							layer.draw();
					  	}
					  }, false);
					  document.getElementById('emoji').addEventListener('click',function(emoji) {
						/*framesPic.moveTo(framesGroup);
						layer.draw();*/
						
						if (document.getElementById('emoji').value == "on"){
							document.getElementById('emoji').value = "off";
							ameba.moveTo(hiddenGroup);
							mustacheOwl.moveTo(hiddenGroup);
							layer.draw();
					  	}
						else {
							document.getElementById('emoji').value = "on";
							ameba.moveTo(amebaGroup);
							mustacheOwl.moveTo(emojiGroup);
							layer.draw();
					  	}
					  }, false);
					  document.getElementById('textOff').addEventListener('click',function(textOff) {
						/*framesPic.moveTo(framesGroup);
						layer.draw();*/
						
						if (document.getElementById('textOff').value == "on"){
							document.getElementById('textOff').value = "off";
							valentine.moveTo(hiddenGroup);
							layer.draw();
					  	}
						else {
							document.getElementById('textOff').value = "on";
							valentine.moveTo(textGroup);
							layer.draw();
					  	}
					  }, false);
					 
					  document.getElementById('share').addEventListener('click',function(share) {
						/*framesPic.moveTo(framesGroup);
						layer.draw();*/
						
						if (document.getElementById('share').value == "on"){
							document.getElementById('share').value = "off";
							yellowCircle.moveTo(hiddenGroup);
							blueCircle.moveTo(hiddenGroup);
							layer.draw();
					  	}
						else {
							document.getElementById('share').value = "on";
							yellowCircle.moveTo(yellowGroup);
							blueCircle.moveTo(blueGroup);
							layer.draw();
					  	}
					  }, false);
					  
					}
	
					/*global avriables */
					framesToggle = 0; //no frame added to frameGroup
					var sources = {
					ameba: 'pics/stickers/ameba.gif',
					frames: 'pics/frames/frame00.png',
					mustache: 'pics/stickers/mustache.png',
					valentine: 'pics/stickers/valentine.png',
					mustacheOwl: 'pics/stickers/mustacheOwl.png',
					};
				
					loadImages(sources, initStage);
                    </script>
            </div> <!-- pic canvas-->
            
            <!-- content container with style examples -->
		    <div id="content">
            	<a href="style.html">CSS Style examples</a>
	    	</div> <!-- content -->	 
            <div style="position: absolute;top: 68px;">   
            <div class="activeBackground">
            <output id="listBack" ></output>
            </div>
            </div>    	
		</div> <!-- main -->
		<footer class="linearBackground">
	    	<nav>
	    		<ul class="bottomNavList">
	    			<li>upload</li>
	    			<li>decorate</li>
	    			<li>share</li>
	    		</ul>
	    	</nav>
	    </footer>
    </body>
</html>
